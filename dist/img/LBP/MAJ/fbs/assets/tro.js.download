(function(w,q,r,b,u,Q){function v(d){return!isNaN(parseFloat(d))&&isFinite(d)}function A(d){return RegExp(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i).test(d)}function E(d){return RegExp(/^[0-9a-f]{32}$/i).test(d)}function F(d,b,c){d=d||[];var a=this,g=Math.floor((new Date).getTime()/1E3);a._session={rtgsession_ts_creation_cookie:d[0],rtgsession_ttl:d[1],rtgsession_seq:d[2],rtgsession_id_prev:d[3],rtgsession_id:d[4],rtgsession_ts:d[5],rtgsession_hits:d[6]};a.setUpNewSession=
function(){a._session.rtgsession_id=b+":"+g;a._session.rtgsession_ts=g;a._session.rtgsession_hits=1};a.setUpNewSessionHeader=function(){a._session.rtgsession_ts_creation_cookie=g;a._session.rtgsession_ttl=c;a._session.rtgsession_seq=1;a._session.rtgsession_id_prev=""};a.getValue=function(){return a._session.rtgsession_ts_creation_cookie+"_"+a._session.rtgsession_ttl+"_"+a._session.rtgsession_seq+"_"+a._session.rtgsession_id_prev+"_"+a._session.rtgsession_id+"_"+a._session.rtgsession_ts+"_"+a._session.rtgsession_hits};
a.getEncodedValue=function(){return encodeURIComponent(a.getValue())};a.createNew=function(){a.setUpNewSessionHeader();a.setUpNewSession()};a.checkError=function(){function c(a,d){b.isValid=!1;b.msg+=b.msg?"|"+a:a}function d(a){if(a&&(a=a.split(":"),a.length&&2===a.length))return A(a[0])&&v(a[1])}var b={isValid:!0,msg:""};try{v(a._session.rtgsession_ts_creation_cookie)?a._session.rtgsession_ts_creation_cookie=parseFloat(a._session.rtgsession_ts_creation_cookie):c("rtgsession_ts_creation_cookie"),
v(a._session.rtgsession_ttl)?a._session.rtgsession_ttl=parseFloat(a._session.rtgsession_ttl):c("rtgsession_ttl"),v(a._session.rtgsession_seq)?a._session.rtgsession_seq=parseFloat(a._session.rtgsession_seq):c("rtgsession_seq"),a._session.rtgsession_id_prev&&!d(a._session.rtgsession_id_prev)?c("rtgsession_id_prev"):(a._session.rtgsession_id_prev_uid=a._session.rtgsession_id_prev.split(":")[0],a._session.rtgsession_id_prev_ts=parseFloat(a._session.rtgsession_id_prev.split(":")[1])),a._session.rtgsession_id&&
!d(a._session.rtgsession_id)?c("rtgsession_id"):(a._session.rtgsession_id_uid=a._session.rtgsession_id.split(":")[0],a._session.rtgsession_id_ts=parseFloat(a._session.rtgsession_id.split(":")[1])),v(a._session.rtgsession_ts)?a._session.rtgsession_ts=parseFloat(a._session.rtgsession_ts):c("rtgsession_ts"),g<parseFloat(a._session.rtgsession_ts)&&c("rtgsession_duration"),v(a._session.rtgsession_hits)||c("rtgsession_hits")}catch(f){l(b.msg+"+checkError+function+failed&trossion="+a.getEncodedValue()+"&timestamp="+
a.timeStamp,G)}return b};a.updateWithNewSession=function(){a._session.rtgsession_seq=parseFloat(a._session.rtgsession_seq)+1;a._session.rtgsession_id_prev=a._session.rtgsession_id;a.setUpNewSession()};a.updateSession=function(){a._session.rtgsession_ts=g;a._session.rtgsession_hits=parseFloat(a._session.rtgsession_hits)+1};a.updateEv=function(c){c=c||{};c.rtgsession_ts_creation_cookie=a._session.rtgsession_ts_creation_cookie;c.rtgsession_ttl=a._session.rtgsession_ttl;c.rtgsession_seq=a._session.rtgsession_seq;
c.rtgsession_id_prev=a._session.rtgsession_id_prev;c.rtgsession_id_prev_uid=a._session.rtgsession_id_prev_uid;c.rtgsession_id_prev_ts=a._session.rtgsession_id_prev_ts;c.rtgsession_id=a._session.rtgsession_id;c.rtgsession_id_uid=a._session.rtgsession_id_uid;c.rtgsession_id_ts=a._session.rtgsession_id_ts;c.rtgsession_ts=a._session.rtgsession_ts;c.rtgsession_hits=a._session.rtgsession_hits;c.rtgsession_duration=a._session.rtgsession_duration;c.rtgsession_seq_duration=a._session.rtgsession_seq_duration;
return c};a.getSessionForTagContainer=function(){return[["rtgsession_ts_creation_cookie",[a._session.rtgsession_ts_creation_cookie]],["rtgsession_ttl",[a._session.rtgsession_ttl]],["rtgsession_seq",[a._session.rtgsession_seq]],["rtgsession_id_prev",[a._session.rtgsession_id_prev]],["rtgsession_id_prev_uid",[a._session.rtgsession_id_prev_uid]],["rtgsession_id_prev_ts",[a._session.rtgsession_id_prev_ts]],["rtgsession_id",[a._session.rtgsession_id]],["rtgsession_id_uid",[a._session.rtgsession_id_uid]],
["rtgsession_id_ts",[a._session.rtgsession_id_ts]],["rtgsession_ts",[a._session.rtgsession_ts]],["rtgsession_hits",[a._session.rtgsession_hits]],["rtgsession_duration",[a._session.rtgsession_duration]],["rtgsession_seq_duration",[a._session.rtgsession_seq_duration]]]};(function(a){if(7>d.length)a.createNew();else{var b=a.checkError();b.isValid?g-parseFloat(a._session.rtgsession_ts)>c?a.updateWithNewSession():a.updateSession():(l(b.msg+"&trossion="+a.getEncodedValue()+"&timestamp="+a.timeStamp,G),
a.createNew())}a._session.rtgsession_id_ts&&a._session.rtgsession_ts&&(a._session.rtgsession_duration=a._session.rtgsession_ts-parseFloat(a._session.rtgsession_id_ts));a._session.rtgsession_id_ts&&a._session.rtgsession_id_prev_ts&&(a._session.rtgsession_seq_duration=a._session.rtgsession_ts-a._session.rtgsession_id_prev_ts)})(a);return a}function H(d,f){function c(){return[{id:"default",version:1,ttl:30,events:[{coef:-0.1071305787347127},{coef:0.216131896556964,cond:"rtgsession_seq"},{coef:1.2656065071142095E-4,
cond:"rtgsession_duration"},{coef:0.07467899685829335,cond:"rtgsession_hits"}]}]}function a(a){try{return c().map(function(c){return B(c,a)})}catch(d){return l(d+"createNewScore: return score empty",m),c()}}function g(a,c){try{var d=parseFloat(a.value),b=parseFloat(a.lower_bound_value),f=parseFloat(a.upper_bound_value),s=parseFloat(c[a.key]);switch(a.operator){case "BETWEEN":return s>b&&s<f;case "==":return c[a.key]===a.value;case "<=":return s<=d;case ">=":return s>=d;case ">":return s>d;case "<":return s<
d;case "AND":return a.valueA&&a.valueB;case "OR":return a.valueA||a.valueB;case "IS NOT NULL":return c.hasOwnProperty(a.key)&&""!==c[a.key]&&void 0!==c[a.key];case "NOT":return!a.value;case "REGEXP":return RegExp(a.value,"giu").test(c[a.key]);default:l(e+error.msg+"+operator not supported for visitor scoring",m)}}catch(h){l(h+"evaluateExpression",m)}}function n(a){try{var c=[];if("string"===typeof a&&0<a.length)for(var d=a.split(" ");d&&0<d.length;){var b=d.shift();if('"'===b[0]){if('"'!==b[b.length-
1])for(;;){var f=d.shift();if(void 0===f){b=void 0;break}b=b+" "+f;if('"'===f[f.length-1])break}void 0!==b&&(b=b.substring(1,b.length-1))}"IS"==b&&"NULL"===d[0]&&(b=b+" "+d.shift());"IS"==b&&("NOT"===d[0]&&"NULL"===d[1])&&(b=b+" "+d.shift()+" "+d.shift());void 0!==b&&c.push(b)}return c}catch(s){l(s+"lexer",m)}return[]}function k(a,c){var b=[];try{n(a).forEach(function(a){var d={operator:a};switch(a){case "BETWEEN":d.upper_bound_value=b.pop();d.lower_bound_value=b.pop();d.key=b.pop();a=g(d,c);break;
case "==":case "<=":case ">=":case ">":case "<":case "REGEXP":d.value=b.pop();d.key=b.pop();a=g(d,c);break;case "AND":case "OR":d.valueB=b.pop();d.valueA=b.pop();a=g(d,c);break;case "NOT":d.value=b.pop();a=g(d,c);break;case "IS NOT NULL":d.key=b.pop();a=g(d,c);break;case "!=":d.value=b.pop();d.key=b.pop();a=k(d.key+" "+d.value+" == NOT",c);break;case "IS NULL":d.key=b.pop(),a=k(d.key+" IS NOT NULL NOT",c)}b.push(a)})}catch(d){l(d+"processReversePolishNotation",m)}return b.pop()}function B(a,c){function d(a,
c){return function(d,b){try{var f=0,h=k(b.cond,c);if(void 0!==h)if("boolean"===typeof h){if(void 0===b.incr||a)b.incr=0;h&&(b.incr+=1);f=b.coef*b.incr}else f=b.coef*parseFloat(c[h])||0;else f=b.coef||0;return d+f}catch(g){return l(g+"setScore: scoreReducer: no score increment",m),d}}}try{var b=a.events.reduce(d(void 0===a.ts||c.rtgsession_ts-a.ts>86400*a.ttl,c),0);a.score=Math.floor(1E3/(1+Math.exp(-b)));a.ts=c.rtgsession_ts}catch(f){l(f+"setScore: could not compute score",m)}return a}function q(a){var c=
{isValid:!0,msg:""};try{c=h.models.reduce(function(a,b){try{b.events.forEach(function(a){if(""===a.coef||void 0===a.coef)c.isValid=!1,c.msg+=c.msg?"|coef":"coef"})}catch(d){l(d+c.msg+"+checkError+function+failed&engagement",m)}return a},c)}catch(b){l(b+c.msg+"+checkError+function+failed&engagement",m)}return c}var h=this;h.models=[];var r=function(a){try{var c=a.filter(function(a){return"default"!==a.id});if(0<c.length)return encodeURIComponent(JSON.stringify(c))}catch(b){l(b+"stringifyModels",m)}return""},
p=function(){return r(h.models)};(function(b,d){try{var f=h,g;a:{try{if(b&&0<b.length){g=JSON.parse(decodeURIComponent(b));break a}}catch(k){l(k+"parseModels",m)}g=[]}f.models=g;0===h.models.length&&(h.models=c());var s=q(h.models);s.isValid?h.models=h.models.map(function(a){return B(a,d)}):(l(s.msg+"init+function+failed+model+not+valid+&engagement="+m),h.models=a(d))}catch(n){l(n+"+init+function+failed&engagement",m),h.models=a(d)}})(d,f);h.lexer=n;h.evaluateExpression=g;h.processReversePolishNotation=
k;h.getScores=function(a){function c(a,b,d){return a+"&"+b}function b(a){return void 0!==a?"rtg"+a.id+"_score="+encodeURIComponent(a.score)+"&rtg"+a.id+"_version="+encodeURIComponent(a.version):""}try{if(0<h.models.length)return h.models.map(b).reduce(c);l("+getScores+function+empty+models&engagement",m)}catch(d){l(d+"getScore",m)}return""};h.getScoresForTagContainer=function(){try{if(0<h.models.length)return h.models.reduce(function(a,c){a.push(["rtg"+c.id+"_score",[c.score]]);a.push(["rtg"+c.id+
"_version",[c.version]]);return a},[])}catch(a){l(a+"getScoresForTagContainer",m)}return[]};h.getEncodedModels=p;h.updateEv=function(a){function c(a,b){a["rtg"+b.id+"_score"]=b.score;a["rtg"+b.id+"_version"]=b.version;return a}try{0<h.models.length&&(a=h.models.reduce(c,a))}catch(b){l(b+"+updateEv fail",m)}return a};h.writeNewModelsToCookie=function(a){try{for(var c=[],d=h.models.reduce(function(a,c){a[c.id]=c;return a},{}),f=0;f<a.length;f+=1){var g=a[f];if(void 0!==d[g.id]){for(var k=0;k<g.events.length;k+=
1)d[g.id].events[k].coef=g.events[k].coef;d[g.id].version=g.version;c.push(d[g.id])}else c.push(a[f])}h.models=c;y("__trossion",b._session.getValue()+"_"+p(),395)}catch(n){l(n+"+writeNewModelsToCookie fail",m)}};return h}function I(d){try{var f=Array.prototype.slice.call(arguments,0);d=f.shift();switch(d){case "init":b.tagid||(b.tagid=f[0],J());break;case "session_ttl":f[0]&&(b.session_ttl=f[0]);break;case "tag":t=[];var c=f[0],f=[],a;for(a in c)if(c.hasOwnProperty(a))if("rtg"===a.substring(0,3))t.push(x(a,
[c[a]])),f.push([a,[c[a]]]);else if("exclusion"===a)t.push("exclusion=1"),f.push([a,["1"]]);else if("m5e"===a||"sha256"===a||"email"===a)t.push(x(a,[c[a]])),f.push([a,[c[a]]]);K(t,f,c)}}catch(g){l(g,R)}}function K(d,f,c){try{f.push(["r1",[n]]);c.r1=n;f.push(["vruid",[u]]);c.vruid=u;if(null!==p&&""!==p){var a;try{a=encodeURIComponent(p)}catch(g){a=escape(p)}f.push(["u",[a]]);c.u=a}var m=b.etag+"_"+(b.version?b.version:"0");f.push(["v",[m]]);c.v=m;var k=z("__trossion").split("_"),B=k.splice(7);b._session=
new F(k,b.uid,b.session_ttl);b._session.updateEv(c);f=f.concat(b._session.getSessionForTagContainer());b._en=new H(B.join("_"),c);b._en.updateEv(c);d.push("trossion="+b._session.getEncodedValue());if(!b.tagid)throw"tagid is missing";d.push(b._en.getScores());f=f.concat(b._en.getScoresForTagContainer());L(d);y("__trossion",b._session.getValue()+"_"+b._en.getEncodedModels(),395);b.segq.queue?b.segq.tag?b.segq.tag.apply(b.segq,c):b.segq.queue.push(c):b.segq.push.apply(b.segq,f)}catch(q){l(q,M)}}function N(){if(!b.unqueue_called){try{if(b.queue)for(;b.queue.length;){var d=
b.queue.shift();I.apply(this,d)}else t=Array.prototype.splice.call(b,0),b.push()}catch(f){l(f,S)}b.unqueue_called=!0}}function O(b){try{b.queue&&(b=b.queue);for(var f=0;f<b.length;f++)if(b[f]&&b[f][0]&&("tagid"===b[f][0]||"init"===b[f][0])&&""!==b[f][1]){var c=b[f][1].split("-");if(2!=c.length)throw"Tagid is misstructured"+encodeURIComponent(b[f][1]);if(!c[1]||!E(c[1]))throw"Tag hash is invalid"+encodeURIComponent(c[1]);if(!c[0]||!v(c[0]))throw"Tagid is invalid"+encodeURIComponent(c[0]);if(0!==c[0].indexOf("6"))throw"Tagid identifier is not valid  "+
encodeURIComponent(c[0]);return b[f][1]}throw"Tagid is missing";}catch(a){l(a,T)}}w._troqck=w._troqck||0;if(!w._troqck){var C,P=!1,n="",p=r,M=3,S=7,T=13,R=14,G=17,m=20;r=p.hostname.split(".").reverse();b.etag=Q;C=2<r.length&&3>=r[1].length&&2>=r[0].length?"."+r[2]+"."+r[1]+"."+r[0]:"."+r[1]+"."+r[0];w!==top&&(q.referrer&&""!==q.referrer)&&(p=q.referrer);var x=function(b,f){for(var c="",a=0;a<f.length;a++)0<a&&(c+="|"),c+=f[a];try{c=b+"="+encodeURIComponent(c)}catch(g){c=b+"="+escape(c)}return c};
b.urlize=x;var z=function(b){var f,c,a,g=q.cookie.split(";");for(f=0;f<g.length;f++)if(c=g[f].substr(0,g[f].indexOf("=")),a=g[f].substr(g[f].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c===b)try{return decodeURIComponent(a)}catch(l){return unescape(a)}return""};b.getCookie=z;var y=function(b,f,c){var a=new Date;a.setDate(a.getDate()+c);var g=f;try{f=encodeURIComponent(f)}catch(m){f=escape(f)}var k=f;c=null===c?"":"; expires="+a.toUTCString();k=k+c+("; domain="+C+"; path=/");q.cookie=b+"="+k;try{var n=
z(b);if(""===n||n!=g){var p=w.location.hostname;if(1===p.split(".").length)q.cookie=b+"="+f+c+"; path=/";else{var h=p.split(".");h.shift();var r="."+h.join(".");q.cookie=b+"="+f+c+"; path=/; domain="+r;n=z(b);if(""===n||n!=g)q.cookie=b+"="+f+c+"; path=/; domain="+C}}}catch(t){l(t,1)}};b.setCookie=y;b.isNumeric=v;b.isValidRUID=A;b.isMD5Valid=E;b.Session=F;b.Engagement=H;var L=function(d,f){try{if(null==b.tagid||""===b.tagid)throw"tagid is missing";for(var c="tagid="+b.tagid+"&",c=c+("r1="+n+"&"),c=
c+("vruid="+u+"&");0<d.length;)c+=d.shift()+"&";if(null!==p&&""!==p){c+="u=";try{c+=encodeURIComponent(p)}catch(a){c+=escape(p)}c+="&"}c+="v="+b.etag+"_";c+=(b.version?b.version:"0")+"&";c+="rnd="+Math.round(2E9*Math.random());c="//"+(f||"mmtro.com")+"/p?"+c;(new Image(1,1)).src=c}catch(g){l(g,M)}};b.troPix=L;b.push=function(){try{for(var d=0;d<arguments.length;d++)t.push(arguments[d])}catch(f){l(f,4)}for(var d=[],c=[],a=[],g={};0<t.length;)try{var n=t.shift(),k=n.shift();if(!k)throw"empty array in taggage";
var k=k.toLowerCase(),m=n,p=!1;if("tagid"===k)b.tagid||(b.tagid=O([[k,m[0]]])),p=!0;else if("rtg"===k.substring(0,3)||-1!==k.indexOf("_")){0===k.indexOf("_")&&(k=k.substring(1,k.length));var h=x(k,m);c.push(h);a.push([k,m]);g[k]=h.split("=")[1]}else"exclusion"===k?(c.push("exclusion=1"),a.push([k,["1"]]),g.exclusion="1"):"m5e"===k||"sha256"===k||"email"===k?(h=x(k,m),c.push(h),a.push([k,m]),g[k]=h.split("=")[1]):d.push(x(k,m))}catch(q){l(q,5)}0<d.length&&l("wrong params in taggage "+d.join("&"),12);
try{0<c.length||p?K(c,a,g):l("p is empty",16)}catch(r){l(r,6)}};b.callTro=I;b.unqueue=N;var D=function(b){var f=q.createElement("script");f.type="text/javascript";f.async=!0;f.src=b;b=q.getElementsByTagName("script")[0];b.parentNode.insertBefore(f,b)};b.createScript=D;b.jarSyncMMTRO=function(d){try{y("__troRUID",d,395),n=b.uid=d}catch(f){l(f,10)}};var l=function(d,f){d=d.message||d;d=encodeURIComponent(d.replace(/ /g,"_"));var c="//err.mmtro.com/error?f=tro.js&u="+encodeURIComponent(w.location.href)+
"&message="+d+"&try="+f+"&v="+b.etag+"_"+(b.version?b.version:"0");(new Image(1,1)).src=c},J=function(){if(null!=b.tagid&&""!=b.tagid){if("00000000-0000-0000-0000-000000000000"!==n)try{D("//cdn.mmtro.com/seg/"+b.tagid.split("-")[0]+".js")}catch(d){l(d,8)}D("//mmtro.com/trojs/"+b.tagid+"/"+n+"/"+u+"/exec.js")}};try{var t=[];b.segq=b.segq||[];if(null==u||""==u||!A(u))throw"vruid is invalid";n=z("__troRUID");A(n)||(n&&l("ruid1 not valid: "+encodeURIComponent(n),18),P=!0,n=u);b.uid=n;b.session_ttl=1800;
b.tagid=O(b);N();P&&y("__troRUID",n,395);J()}catch(U){l(U,11)}w._troqck=1}})
(window, document, location, _troq, "4d2fb8b3-6419-4efc-bea9-baa6ea5f3a27", "ea19f86dfa222b159627c18f");